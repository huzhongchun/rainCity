<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>音频处理</title>
</head>
<body>
	<audio id="bgsound" loop></audio>
	<script type="text/javascript">
		(function(){
	        // function parseUA() {
	        //     var u = navigator.userAgent;
	        //     var u2 = navigator.userAgent.toLowerCase();
	        //     return { //移动终端浏览器版本信息
	        //         trident: u.indexOf('Trident') > -1, //IE内核
	        //         presto: u.indexOf('Presto') > -1, //opera内核
	        //         webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
	        //         gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
	        //         mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
	        //         ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
	        //         android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或uc浏览器
	        //         iPhone: u.indexOf('iPhone') > -1, //是否为iPhone或者QQHD浏览器
	        //         iPad: u.indexOf('iPad') > -1, //是否iPad
	        //         webApp: u.indexOf('Safari') == -1, //是否web应该程序，没有头部与底部
	        //         iosv: u.substr(u.indexOf('iPhone OS') + 9, 3),
	        //         weixin: u2.match(/MicroMessenger/i) == "micromessenger",
	        //         taobao: u.indexOf('AliApp(TB') > -1,
	        //     };
	        // }

        	// var ua = parseUA();

			window.onload = function(){
				var bgsound = document.getElementById('bgsound');

				function hackSafariPlayAudio(){
					bgsound.load(); //for ios 9 load之后再play
					bgsound.play(); //for ios 7/8  play 和 安卓
				}

				bgsound.addEventListener('canplay', function(){
					console.log('canplay')
				}, false);

				bgsound.addEventListener('play', function(){
					document.removeEventListener('touchend', hackSafariPlayAudio, false);
				}, false);
				//用户touch屏幕之后，调用audio play
				document.addEventListener('touchend', hackSafariPlayAudio, false);
				bgsound.src='http://staticbj.im20.com.cn/VML_INTERNAL/vml_show/v1504085318!/impublic/zwj/sound/bgm.mp3';
			}
		})();
	</script>
</body>
</html>